"use strict";exports.id=5731,exports.ids=[5731,6695],exports.modules={65731:(e,t,r)=>{r.r(t),r.d(t,{default:()=>c});var n=r(10326),i=r(96695),o=Object.prototype.hasOwnProperty,s=r(17577),a=r.t(s,2),l=r(98820),u=r(1787);let p="use"in a?s.use:()=>{throw TypeError("SanityLiveStream requires a React version with React.use()")};function c(e){let{query:t,dataset:r,params:a={},perspective:c,projectId:f,stega:d}=e,h=(0,s.useCallback)(e=>(u.Y5.add(e),()=>u.Y5.delete(e)),[]),g=(0,s.useSyncExternalStore)(h,()=>u.id,()=>null),[y,m]=(0,s.useState)(void 0),$=(0,l.i)(e=>{e.post("loader/query-listen",{projectId:f,dataset:r,perspective:c,query:t,params:a,heartbeat:1e4})}),_=(0,l.i)(n=>{if(function e(t,r){var n,i;if(t===r)return!0;if(t&&r&&(n=t.constructor)===r.constructor){if(n===Date)return t.getTime()===r.getTime();if(n===RegExp)return t.toString()===r.toString();if(n===Array){if((i=t.length)===r.length)for(;i--&&e(t[i],r[i]););return -1===i}if(!n||"object"==typeof t){for(n in i=0,t)if(o.call(t,n)&&++i&&!o.call(r,n)||!(n in r)||!e(t[n],r[n]))return!1;return Object.keys(r).length===i}}return t!=t&&r!=r}({projectId:f,dataset:r,query:t,params:a},{projectId:n.projectId,dataset:n.dataset,query:n.query,params:n.params})){let{result:t,resultSourceMap:r,tags:o}=n,s=d?(0,i.stegaEncodeSourceMap)(t,r,{enabled:!0,studioUrl:"/"}):t;console.groupCollapsed("rendering with server action"),e.children({data:s,sourceMap:r,tags:o||[]}).then(e=>{console.log("setChildren(children)"),m(e)},e=>{console.error("rendering with server action: render children error",e)}).finally(()=>console.groupEnd())}});return(0,s.useEffect)(()=>{if(!g)return;let e=g.on("loader/query-change",_),t=setInterval(()=>$(g),1e4);return()=>{clearInterval(t),e()}},[g]),g&&void 0!==y?(0,n.jsx)(n.Fragment,{children:y}):p(e.initial)}c.displayName="SanityLiveStream"},1787:(e,t,r)=>{r.d(t,{Qs:()=>s,Y5:()=>n,id:()=>i,re:()=>o});let n=new Set,i=null;function o(e){for(let t of(i=e,n))t()}function s(e,t){for(let e of n)e()}},96695:(e,t,r)=>{r.r(t),r.d(t,{encodeIntoResult:()=>c,stegaEncodeSourceMap:()=>w,stegaEncodeSourceMap$1:()=>S});var n=r(3900);let i=/_key\s*==\s*['"](.*)['"]/;function o(e){if(!Array.isArray(e))throw Error("Path is not an array");return e.reduce((e,t,r)=>{let n=typeof t;if("number"===n)return`${e}[${t}]`;if("string"===n)return`${e}${0===r?"":"."}${t}`;if(("string"==typeof t?i.test(t.trim()):"object"==typeof t&&"_key"in t)&&t._key)return`${e}[_key=="${t._key}"]`;if(Array.isArray(t)){let[r,n]=t;return`${e}[${r}:${n}]`}throw Error(`Unsupported path segment \`${JSON.stringify(t)}\``)},"")}let s={"\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","'":"\\'","\\":"\\\\"},a={"\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	","\\'":"'","\\\\":"\\"};function l(e){let t;let r=[],n=/\['(.*?)'\]|\[(\d+)\]|\[\?\(@\._key=='(.*?)'\)\]/g;for(;null!==(t=n.exec(e));){if(void 0!==t[1]){let e=t[1].replace(/\\(\\|f|n|r|t|')/g,e=>a[e]);r.push(e);continue}if(void 0!==t[2]){r.push(parseInt(t[2],10));continue}if(void 0!==t[3]){let e=t[3].replace(/\\(\\')/g,e=>a[e]);r.push({_key:e,_index:-1});continue}}return r}function u(e){return e.map(e=>{if("string"==typeof e||"number"==typeof e)return e;if(""!==e._key)return{_key:e._key};if(-1!==e._index)return e._index;throw Error(`invalid segment:${JSON.stringify(e)}`)})}function p(e){return e.map(e=>{if("string"==typeof e||"number"==typeof e)return e;if(-1!==e._index)return e._index;throw Error(`invalid segment:${JSON.stringify(e)}`)})}function c(e,t,r){return function e(t,r,i=[]){if(null!==t&&Array.isArray(t))return t.map((t,o)=>{if((0,n.Uy)(t)){let n=t._key;if("string"==typeof n)return e(t,r,i.concat({_key:n,_index:o}))}return e(t,r,i.concat(o))});if((0,n.Uy)(t)){if("block"===t._type||"span"===t._type){let n={...t};return"block"===t._type?n.children=e(t.children,r,i.concat("children")):"span"===t._type&&(n.text=e(t.text,r,i.concat("text"))),n}return Object.fromEntries(Object.entries(t).map(([t,n])=>[t,e(n,r,i.concat(t))]))}return r(t,i)}(e,(e,n)=>{if("string"!=typeof e)return e;let i=function(e,t){var r;if(!t?.mappings)return;let n=(r=p(e),`$${r.map(e=>"string"==typeof e?`['${e.replace(/[\f\n\r\t'\\]/g,e=>s[e])}']`:"number"==typeof e?`[${e}]`:""!==e._key?`[?(@._key=='${e._key.replace(/['\\]/g,e=>s[e])}')]`:`[${e._index}]`).join("")}`);if(void 0!==t.mappings[n])return{mapping:t.mappings[n],matchedPath:n,pathSuffix:""};let i=p(e).map(e=>"string"==typeof e?`['${e.replace(/[\f\n\r\t'\\]/g,e=>s[e])}']`:"number"==typeof e?`[${e}]`:""!==e._key?`[?(@._key=='${e._key.replace(/['\\]/g,e=>s[e])}')]`:`[${e._index}]`);for(let e=i.length-1;e>=0;e--){let r=`$${i.slice(0,e).join("")}`,o=t.mappings[r];if(o){let e=n.substring(r.length);return{mapping:o,matchedPath:r,pathSuffix:e}}}}(n,t);if(!i)return e;let{mapping:o,matchedPath:a}=i;if("value"!==o.type||"documentValue"!==o.source.type)return e;let u=t.documents[o.source.document],c=t.paths[o.source.path],f=l(a);return r({sourcePath:l(c).concat(n.slice(f.length)),sourceDocument:u,resultPath:n,value:e})})}let f="drafts.";function d(e){return e.startsWith(f)}function h(e){return e.startsWith("versions.")}let g=({sourcePath:e,resultPath:t,value:r})=>{if(function(e){return!!/^\d{4}-\d{2}-\d{2}/.test(e)&&!!Date.parse(e)}(r)||function(e){try{let{protocol:t}=new URL(e,e.startsWith("/")?"https://acme.com":void 0);return m.has(t)||t.startsWith("web+")}catch{return!1}}(r))return!1;let n=e.at(-1);return!("slug"===e.at(-2)&&"current"===n||"string"==typeof n&&(n.startsWith("_")||n.endsWith("Id"))||e.some(e=>"meta"===e||"metadata"===e||"openGraph"===e||"seo"===e)||$(e)||$(t)||"string"==typeof n&&y.has(n))},y=new Set(["color","colour","currency","email","format","gid","hex","href","hsl","hsla","icon","id","index","key","language","layout","link","linkAction","locale","lqip","page","path","ref","rgb","rgba","route","secret","slug","status","tag","template","theme","type","textTheme","unit","url","username","variant","website"]),m=new Set(["app:","data:","discord:","file:","ftp:","ftps:","geo:","http:","https:","imap:","javascript:","magnet:","mailto:","maps:","ms-excel:","ms-powerpoint:","ms-word:","slack:","sms:","spotify:","steam:","teams:","tel:","vscode:","zoom:"]);function $(e){return e.some(e=>"string"==typeof e&&null!==e.match(/type/i))}let _=[8203,8204,8205,65279],v=_.map(e=>String.fromCharCode(e)),b=[8203,8204,8205,8290,8291,8288,65279,8289,119155,119156,119157,119158,119159,119160,119161,119162];Object.fromEntries(_.map((e,t)=>[e,t])),Object.fromEntries(b.map((e,t)=>[e,t.toString(16)]));let k=String.fromCodePoint(_[0]).repeat(4);function w(e,t,r){let{filter:n,logger:s,enabled:a}=r;if(!a){let n="config.enabled must be true, don't call this function otherwise";throw s?.error?.(`[@sanity/client]: ${n}`,{result:e,resultSourceMap:t,config:r}),TypeError(n)}if(!t)return s?.error?.("[@sanity/client]: Missing Content Source Map from response body",{result:e,resultSourceMap:t,config:r}),e;if(!r.studioUrl){let n="config.studioUrl must be defined";throw s?.error?.(`[@sanity/client]: ${n}`,{result:e,resultSourceMap:t,config:r}),TypeError(n)}let l={encoded:[],skipped:[]},p=c(e,t,({sourcePath:e,sourceDocument:t,resultPath:i,value:a})=>{var p;let c;if(("function"==typeof n?n({sourcePath:e,resultPath:i,filterDefault:g,sourceDocument:t,value:a}):g({sourcePath:e,resultPath:i,value:a}))===!1)return s&&l.skipped.push({path:o(u(e)),value:`${a.slice(0,20)}${a.length>20?"...":""}`,length:a.length}),a;s&&l.encoded.push({path:o(u(e)),value:`${a.slice(0,20)}${a.length>20?"...":""}`,length:a.length});let{baseUrl:y,workspace:m,tool:$}=("/"!==(c="string"==typeof(p="function"==typeof r.studioUrl?r.studioUrl(t):r.studioUrl)?p:p.baseUrl)&&(c=c.replace(/\/$/,"")),"string"==typeof p?{baseUrl:c}:{...p,baseUrl:c});if(!y)return a;let{_id:_,_type:b,_projectId:w,_dataset:S}=t;return function(e,t,r="auto"){return!0!==r&&("auto"!==r||e&&"string"==typeof e&&Date.parse(e)||function(e){try{return new URL(e,e.startsWith("/")?"https://example.com":void 0),!0}catch{return!1}}(e))?e:`${e}${function(e){if(void 0===e)return"";let t="string"==typeof e?e:JSON.stringify(e),r=new TextEncoder().encode(t),n="";for(let e=0;e<r.length;e++){let t=r[e];n+=v[t>>6&3]+v[t>>4&3]+v[t>>2&3]+v[3&t]}return k+n}(t)}`}(a,{origin:"sanity.io",href:function(e){let{baseUrl:t,workspace:r="default",tool:n="default",id:i,type:s,path:a,projectId:l,dataset:p}=e;if(!t)throw Error("baseUrl is required");if(!a)throw Error("path is required");if(!i)throw Error("id is required");if("/"!==t&&t.endsWith("/"))throw Error("baseUrl must not end with a slash");let c="default"===r?void 0:r,g="default"===n?void 0:n,y=h(i)?i.split(".").slice(2).join("."):d(i)?i.slice(f.length):i,m=Array.isArray(a)?o(u(a)):a,$=new URLSearchParams({baseUrl:t,id:y,type:s,path:m});if(c&&$.set("workspace",c),g&&$.set("tool",g),l&&$.set("projectId",l),p&&$.set("dataset",p),d(i)||h(i)){if(h(i)){let e=function(e){if(!h(e))return;let[t,r,...n]=e.split(".");return r}(i);$.set("perspective",e)}}else $.set("perspective","published");let _=["/"===t?"":t];c&&_.push(c);let v=["mode=presentation",`id=${y}`,`type=${s}`,`path=${encodeURIComponent(m)}`];return g&&v.push(`tool=${g}`),_.push("intent","edit",`${v.join(";")}?${$}`),_.join("/")}({baseUrl:y,workspace:m,tool:$,id:_,type:b,path:e,...!r.omitCrossDatasetReferenceData&&{dataset:S,projectId:w}})},!0)});if(s){let e=l.skipped.length,t=l.encoded.length;if((e||t)&&((s?.groupCollapsed||s.log)?.("[@sanity/client]: Encoding source map into result"),s.log?.(`[@sanity/client]: Paths encoded: ${l.encoded.length}, skipped: ${l.skipped.length}`)),l.encoded.length>0&&(s?.log?.("[@sanity/client]: Table of encoded paths"),(s?.table||s.log)?.(l.encoded)),l.skipped.length>0){let e=new Set;for(let{path:t}of l.skipped)e.add(t.replace(i,"0").replace(/\[\d+\]/g,"[]"));s?.log?.("[@sanity/client]: List of skipped paths",[...e.values()])}(e||t)&&s?.groupEnd?.()}return p}[..._,...b].map(e=>`\\u{${e.toString(16)}}`).join("");var S=Object.freeze({__proto__:null,stegaEncodeSourceMap:w})}};